%% title: PART 3: Information on Changes Due to IO Grant Work
%% date: 2017-04-17

<p>The IO grant work is at its wrap up. This note lists some of the last-minute changes to the plans delineated in earlier communications (<a href="http://rakudo.org/2017/02/26/advance-notice-of-significant-changes/">[1]</a>, <a href="http://rakudo.org/2017/04/02/upgrade-information-for-changes-due-to-io-grant-work/">[2], <a href="http://rakudo.org/2017/04/03/part-2-upgrade-information-for-changes-due-to-io-grant-work/">[3]</a>). Most of the listed items do not require any changes to users' code.</p>
<ul>
<li>We implemented <a href="https://docs.perl6.org/routine/sibling"><code>IO::Path.sibling</code></a></li>
<li>The promised <code>IO::Path.concat-with</code> was instead added as the much shorter <a href="https://docs.perl6.org/routine/add"><code>IO::Path.add</code></a>. Due to large ecosystem usage, <code>IO::Path.child</code> was left as is for now. The secure version is already written and <code>.child</code> will be swapped to use it later on; possibly around 6.d time. This will allow more time for users to update to the <code>.add</code> routine, where the secureness isn't needed.</li>
<li><code>&amp;mkdir</code> multi candidate that takes a list of directories has been removed. IO::Path.mkdir has been changed to return the invocant on success, to mirror the subroutine form's behaviour</li>
<li>The changes to <code>&amp;symlink</code> and <code>&amp;link</code> affected <code>IO::Path.symlink</code> and <code>IO::Path.link</code> as well. The new order of arguments is <code>$existing-thing.symlink: $the-new-thing-we're-creating</code> (same for <code>.link</code>)</li>
<li><code>role IO</code> was promised to be removed. Essentially it was, none of the types that did it do it anymore. However, the role was brought back, to be done by <code>IO::Path</code> and <code>IO::Special</code>. The role provides no methods, but when we'll make our coercers type-check the results of the coercion, we'll need <code>IO::Path</code> to be of type <code>IO</code>, or all of our shiny <code>IO()</code> coercers will explode. As <code>IO::Special</code> is meant to be a fake-IO::Path-lite, it does <code>IO</code> role as well.</li>
<li>Many of the IO routines were changed from taking <code>Str</code> arguments to taking <code>IO()</code> arguments (<code>Str</code> coerces to <code>IO</code> just fine, so no changes to code are needed on your part). When paths are given as <code>IO::Path</code>s, this avoids needless waste of cycles to convert the <code>IO::Path</code> to <code>Str</code> and then to <code>IO::Path</code> again. More importantly, since <code>IO::Path.Str</code> doesn't consider <code>$.CWD</code> into account, this fixes all potential bugs where the <code>IO::Path</code> given as arg was created with <code>$.CWD</code> other than current <code>$*CWD</code></li>
</ul>
<h2>Help and More Info</h2>
<p>If you need help or more information, please <a href="https://webchat.freenode.net/?channels=#perl6">join our IRC channel</a> and ask there. You can also contact the person performing this work via <a href="https://twitter.com/zoffix">Twitter @zoffix</a> or by talking to user <code>Zoffix</code> in <a href="https://webchat.freenode.net/?channels=#perl6">our dev IRC channel</a></p>
